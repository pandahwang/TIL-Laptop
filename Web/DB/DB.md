# DBMS  
DataBase Maintain System  

보통 Web 서버와 WAS로 만듦  
Web 서버는 클라이언트가 요청한 정적 정보를 전달함.  
WAS는 DBMS로부터 실시간/동적 정보를 가공, 클라이언트에게 전달함.  

초기 데이터는 파일 시스템(메모장) 방식으로 저장되어 있었음.  

데이터가 저장되는 걸 DB라 하고, 이를 관리하는 시스템을 DBMS라고 함.  

Data(데이터) : 가공되지 않은 자료. 목적성이 없음.  
Information(정보) : 사용하기 용이하도록 처리(분석, 가공)된 자료.  

효율적인 데이터 관리를 위한 조건  
- 데이터를 통합하여 관리  
- 일관된 방법으로 관리  
- 데이터 누락 및 중복을 제거  
- 여러 사용자가 공동으로 실시간 사용 가능해야 함  

구조화된 데이터의 집합(DB)을, 효율적으로 관리하는 것이 데이터베이스 관리 시스템(DBMS)임.  
보통은 DB와 DBMS를 구별하지 않고, DB/데이터베이스라고 부름.  

DB를 통해 응용 프로그램의 서비스 제공과 데이터 관련 적업 효율을 높일 수 있음.  
여러 응용 프로그램들이 하나의 통합된 데이터를 같은 방식으로 사용/관리 하므로 데이터 누락/중복을 방지할 수 있음.  

---
## 데이터 모델 종류  

- 계층형 데이터 모델  
Tree 구조를 활용하여, 데이터 관련성을 부모 자식 같은 관계로 정의하고 관리함.  

- 네트워크형 데이터 모델  
망형 데이터 모델. 그래프 구조를 기반으로 관리함.  
개체 간 관계를 그래프 구조로 연결하므로, 자식 개체가 여러 부모 개체를 가질 수 있음. (계층형보다 서로 관계를 맺기 쉬움)  
그러나 한 눈에 파악하기 힘듦.  

- 객체 지향형 데이터 모델  
객체지향 개념을 데이터베이스에 그대로 접목시킨 모델.  
그러나 완전히 적용하는 것은 쉽지 않아, 이를 적용한 DBMS가 많지 않음.  

- 관계형 데이터 모델  
DB의 근간. 근래 SQL DB는 대부분 이를 사용함  
다른 모델과 달리, 데이터 간 관계에 초점을 둠.  
데이터들의 `독립 특성`만을 규정하여 데이터 묶음으로 나눔.  
그리고 중복이 발생할 수 있는 묶음은, 별개로 나누어서 연결함. (관계를 맺어줌)  
관계를 강조하기 위해, relational을 앞에 붙여 `RDBMS`라고 부름.  
![alt text](../../image/relation_data_model.PNG)  

RDBMS를 다루는 언어로는 MS-SQL, MySQL, MariaDB, PostgreSQL, DB2, ORACLE 등이 있음.  
이 중, ORACLE이 가장 많이 쓰임.  

---

### 관계형 데이터 모델의 핵심 구성 요소  

<table border>
  <thead>
    <tr>
      <th>이름</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>개체</td>
      <td>데이터화하려는 사물, 개념의 정보 단위. table 개념과 대응되며, table은 릴레이션으로 표기하기도 함.</td>
    </tr>
    <tr>
      <td>속성</td>
      <td>개체를 구성하는 데이터의 가장 작은 '논리적 단위'. 데이터의 종류, 특성, 상태 등을 정의함. column 개념과 대응됨.</td>
    </tr>
    <tr>
      <td>관계</td>
      <td>개체와 개체, 또는 속성 간의 연관성을 나타냄. 테이블 간의 관계를 외래키(foreign key) 등으로 구현하여 사용함.</td>
    </tr>
  </tbody>
</table>


RDBMS는 우리가 평소에 쓰는 xmls 문서라고 보면 됨.  

행(→) : 데이터 한 단위. 각각의 한 행을 row, tuple, `Record`라고 부름.  

열(↓) : 데이터를 대표하는 이름과 공통 특성을 정의함.  
저장 정보의 종류, 저장 가능한 값의 최대 길이, 값의 중복 허용 유무 등을 지정할 수 있음.  
각각의 한 열을 속성(attribute), field, column 등으로 부름.  

관계 : 테이블 하나하나를 의미함.  

키(key) : 데이터를 구별할 수 있는 유일한 값.  
하나의 테이블을 구성하는 여러 열 중에서, 특별한 의미를 지닌 하나 또는 여러 열의 조합을 의미함.  
종류별로 데이터를 구별하거나, 테이블 간의 연관 관계를 표현할 때, 키로 지정한 열을 사용함.  

---

#### 키의 종류  
`기본키(primary key)` - 기본키 PK는 가장 중요한 키. 한 테이블 내에서 중복되지 않는 값만 가질 수 있는 키.
- 속성 :  
    테이블에 저장된 행을 식별할 수 있는 유일한 값.  
    값의 중복이 없어야 함.  
    NULl 값을 가질 수 없음.  
하나 또는 여러 열의 조합으로 만들 수 있음.  
대부분의 경우, 개인 정보 노출이 가장 적은 데이터를 선정함.  

`보조키 (alternate key)` - 대체키라고도 함. 후보키 중에서 기본키로 지정되지 않은 열.  

`후보키(candidate key)` - 기본키가 될 수 있는 모든 키들.  

![alt text](../../image/dbkeys.PNG)  

`외래키(foreign key)` - 외부키라고도 부름. 특정 테이블에 포함되어 있으면서, 다른 테이블의 기본키로 지정된 키.  

이 때, 다른 테이블에서 외래키를 `참조`<sup>(reference)</sup>한다고 표현함.  
참조를 통해, 데이터 중복을 피할 수 있음. 셀 병합과 유사한 효과.  
![alt text](../../image/foreignkey.PNG)  

`복합키(composite key)` - 두 개 이상의 열(속성)을 조합하여 기본키 역할을 할 수 있게 만든 키.  
하나의 열만으로는 행을 식별하는 것이 불가능할 때 사용함. 2~10개가 넘는 열을 조합하기도 함.  


### SQL(Structured Query Language)  
DBMS를 관리하기 위해 사용하는 언어.  
SQL을 통해 데이터베이스에서 여러 데이터 관련 작업을 수행할 수 있음.  

사용 목적에 따라 명령어가 나뉨.  
<table border>
  <thead>
    <tr>
      <th>종류</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>DQL</td>
      <td>RDBMS에 저장한 데이터를 조회하는 명령어</td>
    </tr>
    <tr>
      <td>DML</td>
      <td>데이터를 저장, 수정, 삭제하는 명령어</td>
    </tr>
    <tr>
      <td>DDL</td>
      <td>데이터 관리를 위해 테이블을 포함한 여러 객체를 생성, 수정, 삭제하는 명령어</td>
    </tr>
    <tr>
      <td>TCL</td>
      <td>트랜잭션 데이터의 영구 저장/취소 등과 관련된 명령어</td>
    </tr>
    <tr>
      <td>DCL</td>
      <td>데이터 사용 권한과 관련된 명령어</td>
    </tr>
  </tbody>
</table>


# Oracle DBMS  
가장 많이 사용되는 SQL  
대부분 2007년에 나온 11g 버전을 사용함.  

## 자료형  
데이터베이스에 저장하는 데이터는 다양한 형태<sub>숫자, 문자 등</sup>를 가지고 있음.  
데이터의 형태를 자료형이라고 부름.  

Oracle의 자료형 종류  
(*가 있는 자료형을 주로 사용함.)  

- 스칼라형 : 하나의 자료형에 맞춰 한 종류의 데이터를 저장할 수 있는 자료형.  
    - *`VARCHAR2`(길이) : 가변 길이 문자열 데이터를 저장. (4000~1byte)  
    - *`NUMBER`(전체 자릿수, 소수점 이하 자릿수) : ±38자릿수 숫자를 저장. 저장할 전체 자리수와, 그 중에서 소수점 자리수를 지정할 수 있음.  
    - *`DATE` : 날씨 형식을 저장.  
    - CHAR(길이) : 문자열 데이터를 저장. 한 글자를 쓰더라도 4000byte 고정. 거의 사용하지 않음.  
    - BLOB, CLOB : 이진 데이터 파일, 문자 데이터 파일을 저장.  
    - BFILE : 이진 데이터 파일을 저장.  
  
- 컬렉션형 : 한 번에 여러 데이터를 저장할 수 있는 자료형  
VARRAY, NESTED, TABLE  

## 객체  
데이터를 저장하고 관리하기 위한 논리 구조를 가진 구성 요소.  

객체 종류  

<table border="1">
  <thead>
    <tr>
      <th>용어</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>테이블 (table)</td>
      <td>데이터를 저장하는 장소</td>
    </tr>
    <tr>
      <td>인덱스 (index)</td>
      <td>검색 효율을 높이기 위해 사용</td>
    </tr>
    <tr>
      <td>뷰 (view)</td>
      <td>하나 또는 여러 개의 선별된 데이터들을 논리적으로 연결하여 하나의 테이블처럼 사용하게 해줌</td>
    </tr>
    <tr>
      <td>시퀀스 (sequence)</td>
      <td>호출될 때마다 자동으로 일련 번호를 생성해줌</td>
    </tr>
    <tr>
      <td>시노님 (synonym)</td>
      <td>오라클 객체의 별칭을 지정</td>
    </tr>
    <tr>
      <td>프로시저 (procedure)</td>
      <td>프로그래밍 연산 및 기능 수행이 가능함 (반환값 없음)</td>
    </tr>
    <tr>
      <td>함수 (function)</td>
      <td>프로그래밍 연산 및 기능 수행이 가능함 (반환값 있음)</td>
    </tr>
    <tr>
      <td>패키지 (package)</td>
      <td>관련 있는 프로시저와 함수를 보관함. 자바 패키지와 유사.</td>
    </tr>
    <tr>
      <td>트리거 (trigger)</td>
      <td>데이터 관련 작업의 연결 및 방지 관련 기능을 제공함</td>
    </tr>
  </tbody>
</table>


#### PL/SQL  
ORACLE을 포함한 기존 SQL만으로는, 복잡한 RDBMS를 다루기 힘듦.  
이를 보완한 것이 PL/SQL.  

## 사용법  
- 데이터베이스 접속 예시  
    1. 접속(ID/PW)  
    2. DB 선택  
    3. DB 조회/수정  

    SCOTT 계정 잠금 풀기  
    ```
    ALTER USER SCOTT  
    IDENTIFIED BY tiger
    ACCOUNT UNLOCK;
    ```
    SCOTT 계정 연결  
    ```
    CONN scott/tiger  
    ```

    scott db의 EMP 테이블 구성 요소
    ![alt text](../../image/scottdb.png)  
    DEPT 테이블 구성 요소  
    ![alt text](../../image/scottdb_dept.png)  
    SALGRADE 테이블 구성 요소  
    ![alt text](../../image/scottdb_salgrade.png)  
    table 구성 요소는 대문자로 적는 것을 권장.  

### 데이터 조회  

#### SELECT문  
데이터를 선택하는 명령어.  

셀렉션 : 행 단위로 데이터를 선택(조회)함.  

프로젝션 : 열 단위로 데이터를 조회함.  
여러 열을 선택하여 데이터를 조회할 수 있음.   

조인 : 셀렉션과 프로젝션을 함께 사용.  
원하는 행의 특정 열만 선택할 수 있음.  
두 개 이상의 테이블을 하나의 테이블로 붙인 것처럼 조회할 수 있음.  

SELECT문은 FROM절과 함께 사용함.  
```
SELECT [옵션] [조회할 열1 이름], [열2 이름], ... , [열N 이름]
FROM [조회할 테이블 이름]
WHERE [조건]
```
- 옵션  
    - DISTINCT 옵션  
    SELECT문은 데이터를 선택할 때, 같은 값들도 중복해서 선택됨.  
    DISTINCT 옵션을 넣으면, 데이터를 선택할 때, 중복된 값은 선택하지 않음.  

    - ALL 옵션  
    SELECT문의 기본값.  

- 별칭(ALIAS)  
    컬럼의 이름을 숨기거나,  
    SELECT문에 산술연산 구문을 넣으면, 그대로 수행하고 칼럼명도 그대로 출력되는데, 칼럼명을 지정할 수 있음.  
    별칭을 붙일 칼럼 뒤에 작성함.  
    ```
    [별칭을 붙일 칼럼] [별칭]
    [별칭을 붙일 칼럼] ["별칭"]
    [별칭을 붙일 칼럼] as ["별칭"]
    [별칭을 붙일 칼럼] as [별칭] → 주로 사용
    ```
    
    #### 산술연산할 때 대상으로 null 값이 들어가면, 결과가 null이 되어버림.  
    
- WHERE 조건  
    - 비교 연산자  
        = , >, <, >=, <=  
        <>, !=, ^= (다르다)  
    - 논리 연산자
        AND, OR , NOT  
    - BETWEEN AND, NOT BETWEEN AND 연산자  

    - IN 연산자  

    - LIKE 연산자 + 와일드카드  

